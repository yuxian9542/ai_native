# ğŸ§ª Excelæ™ºèƒ½åˆ†æç³»ç»Ÿ - æµ‹è¯•å¥—ä»¶

æœ¬ç›®å½•åŒ…å«å®Œæ•´çš„æµ‹è¯•è„šæœ¬ï¼Œç”¨äºéªŒè¯ç³»ç»Ÿçš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸ“ æµ‹è¯•æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæµ‹è¯•è„šæœ¬

| æ–‡ä»¶å | æè¿° | åŠŸèƒ½ |
|--------|------|------|
| `run_all_tests.py` | ä¸»æµ‹è¯•è„šæœ¬ | è¿è¡Œæ‰€æœ‰æµ‹è¯• |
| `quick_test.py` | å¿«é€Ÿæµ‹è¯• | éªŒè¯åŸºæœ¬åŠŸèƒ½ |
| `test_backend.py` | å®Œæ•´åç«¯æµ‹è¯• | æµ‹è¯•æ‰€æœ‰åç«¯åŠŸèƒ½ |
| `test_excel_processing.py` | Excelå¤„ç†æµ‹è¯• | æµ‹è¯•Excelé¢„å¤„ç†å’Œç´¢å¼• |
| `test_code_execution.py` | ä»£ç æ‰§è¡Œæµ‹è¯• | æµ‹è¯•ä»£ç ç”Ÿæˆå’Œæ‰§è¡Œ |

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
cd week6_hw/test
python run_all_tests.py
```

### 2. è¿è¡Œå•ä¸ªæµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯•
python quick_test.py

# Excelå¤„ç†æµ‹è¯•
python test_excel_processing.py

# ä»£ç æ‰§è¡Œæµ‹è¯•
python test_code_execution.py

# å®Œæ•´åç«¯æµ‹è¯•
python test_backend.py
```

## ğŸ“‹ æµ‹è¯•å†…å®¹

### å¿«é€Ÿæµ‹è¯• (`quick_test.py`)
- âœ… åç«¯æœåŠ¡çŠ¶æ€æ£€æŸ¥
- âœ… æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- âœ… æ–‡ä»¶åˆ—è¡¨è·å–
- âœ… æ–‡ä»¶è¯¦æƒ…è·å–

### Excelå¤„ç†æµ‹è¯• (`test_excel_processing.py`)
- âœ… Excelæ–‡ä»¶é¢„å¤„ç†
- âœ… æ— å…³è¡Œè¯†åˆ«
- âœ… åˆå¹¶å•å…ƒæ ¼å¤„ç†
- âœ… å¤šçº§è¡¨å¤´å¤„ç†
- âœ… æ•°æ®æ¸…ç†å’Œæ ‡å‡†åŒ–
- âœ… å…ƒæ•°æ®ç”Ÿæˆ
- âœ… Elasticsearchç´¢å¼•
- âœ… æ–‡ä»¶æ£€ç´¢åŠŸèƒ½

### ä»£ç æ‰§è¡Œæµ‹è¯• (`test_code_execution.py`)
- âœ… Pythonä»£ç ç”Ÿæˆ
- âœ… ä»£ç å®‰å…¨æ‰§è¡Œ
- âœ… æ•°æ®åˆ†æåŠŸèƒ½
- âœ… å›¾è¡¨ç”Ÿæˆ
- âœ… å¤æ‚åˆ†æåœºæ™¯

### å®Œæ•´åç«¯æµ‹è¯• (`test_backend.py`)
- âœ… ç¯å¢ƒé…ç½®æ£€æŸ¥
- âœ… Elasticsearchè¿æ¥
- âœ… OpenAIè¿æ¥
- âœ… Excelé¢„å¤„ç†
- âœ… å…ƒæ•°æ®ç”Ÿæˆ
- âœ… æ–‡ä»¶æ£€ç´¢
- âœ… ä»£ç ç”Ÿæˆ
- âœ… ä»£ç æ‰§è¡Œ
- âœ… APIç«¯ç‚¹
- âœ… å®Œæ•´å·¥ä½œæµç¨‹

## ğŸ”§ æµ‹è¯•ç¯å¢ƒè¦æ±‚

### å¿…éœ€æœåŠ¡
1. **åç«¯æœåŠ¡**: è¿è¡Œåœ¨ http://localhost:8000
2. **Elasticsearch**: è¿è¡Œåœ¨ http://localhost:9200
3. **OpenAI API**: é…ç½®æœ‰æ•ˆçš„APIå¯†é’¥

### æµ‹è¯•æ•°æ®
- ä½¿ç”¨ `data/original/` ç›®å½•ä¸­çš„Excelæ–‡ä»¶
- è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•CSVæ•°æ®
- åˆ›å»ºä¸´æ—¶æµ‹è¯•æ–‡ä»¶

## ğŸ“Š æµ‹è¯•ç»“æœç¤ºä¾‹

```
ğŸš€ Excelæ™ºèƒ½åˆ†æç³»ç»Ÿ - å®Œæ•´æµ‹è¯•å¥—ä»¶
============================================================
1. æ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€...
âœ… åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸

============================================================
ğŸ§ª å¿«é€ŸåŠŸèƒ½æµ‹è¯•
============================================================
1. æ£€æŸ¥åç«¯æœåŠ¡...
   âœ… åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸
2. æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ...
   âœ… æ–‡ä»¶ä¸Šä¼ æˆåŠŸ: cola.xlsx
3. æµ‹è¯•æ–‡ä»¶åˆ—è¡¨...
   âœ… æ–‡ä»¶åˆ—è¡¨è·å–æˆåŠŸ: 1 ä¸ªæ–‡ä»¶
4. æµ‹è¯•æ–‡ä»¶è¯¦æƒ…...
   âœ… æ–‡ä»¶è¯¦æƒ…è·å–æˆåŠŸ: cola.xlsx

ğŸ‰ å¿«é€Ÿæµ‹è¯•å®Œæˆï¼
============================================================

ğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»
============================================================
å¿«é€ŸåŠŸèƒ½æµ‹è¯•                : âœ… é€šè¿‡
Excelå¤„ç†åŠŸèƒ½æµ‹è¯•           : âœ… é€šè¿‡
ä»£ç ç”Ÿæˆå’Œæ‰§è¡Œæµ‹è¯•          : âœ… é€šè¿‡
å®Œæ•´åç«¯åŠŸèƒ½æµ‹è¯•            : âœ… é€šè¿‡
------------------------------------------------------------
æ€»è®¡: 4/4 ä¸ªæµ‹è¯•é€šè¿‡
ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç³»ç»ŸåŠŸèƒ½å®Œæ•´ï¼
============================================================
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **åç«¯æœåŠ¡æœªè¿è¡Œ**
   ```
   âŒ åç«¯æœåŠ¡æœªè¿è¡Œï¼
   è¯·å…ˆå¯åŠ¨åç«¯æœåŠ¡:
   cd week6_hw
   python -c "from backend.main import app; import uvicorn; uvicorn.run(app, host='0.0.0.0', port=8000)"
   ```

2. **Elasticsearchè¿æ¥å¤±è´¥**
   ```
   âŒ Elasticsearchè¿æ¥å¤±è´¥: Connection refused
   è¯·ç¡®ä¿Elasticsearchè¿è¡Œåœ¨ http://localhost:9200
   ```

3. **OpenAI APIé”™è¯¯**
   ```
   âŒ OpenAIè¿æ¥å¤±è´¥: Invalid API key
   è¯·æ£€æŸ¥ .env æ–‡ä»¶ä¸­çš„ OPENAI_API_KEY
   ```

4. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   ```
   âŒ æ–‡ä»¶ä¸Šä¼ å¤±è´¥: HTTP 500
   æ£€æŸ¥åç«¯æ—¥å¿—æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
   ```

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹è¯¦ç»†é”™è¯¯**
   ```bash
   python test_backend.py 2>&1 | tee test_output.log
   ```

2. **å•ç‹¬æµ‹è¯•æŸä¸ªåŠŸèƒ½**
   ```bash
   python -c "
   import asyncio
   from test.test_excel_processing import test_excel_processing
   asyncio.run(test_excel_processing())
   "
   ```

3. **æ£€æŸ¥æµ‹è¯•æ•°æ®**
   ```bash
   ls -la data/original/
   ls -la data/processed/
   ls -la data/output/
   ```

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

### é¢„æœŸæ€§èƒ½æŒ‡æ ‡

| åŠŸèƒ½ | é¢„æœŸæ—¶é—´ | è¯´æ˜ |
|------|----------|------|
| æ–‡ä»¶ä¸Šä¼  | < 5ç§’ | å°æ–‡ä»¶(< 1MB) |
| Excelé¢„å¤„ç† | < 30ç§’ | ä¸­ç­‰æ–‡ä»¶(1-10MB) |
| å…ƒæ•°æ®ç”Ÿæˆ | < 1åˆ†é’Ÿ | åŒ…å«AIå¤„ç† |
| ä»£ç ç”Ÿæˆ | < 10ç§’ | GPT-4å“åº” |
| ä»£ç æ‰§è¡Œ | < 60ç§’ | åŒ…å«å›¾è¡¨ç”Ÿæˆ |

### èµ„æºä½¿ç”¨

- **å†…å­˜**: å»ºè®®è‡³å°‘2GBå¯ç”¨å†…å­˜
- **ç£ç›˜**: æµ‹è¯•æ–‡ä»¶çº¦100MB
- **ç½‘ç»œ**: éœ€è¦ç¨³å®šçš„OpenAI APIè¿æ¥

## ğŸ”„ æŒç»­é›†æˆ

### è‡ªåŠ¨åŒ–æµ‹è¯•

```bash
#!/bin/bash
# å¯åŠ¨æœåŠ¡
cd week6_hw
python -c "from backend.main import app; import uvicorn; uvicorn.run(app, host='0.0.0.0', port=8000)" &
BACKEND_PID=$!

# ç­‰å¾…æœåŠ¡å¯åŠ¨
sleep 10

# è¿è¡Œæµ‹è¯•
cd test
python run_all_tests.py
TEST_RESULT=$?

# æ¸…ç†
kill $BACKEND_PID
exit $TEST_RESULT
```

## ğŸ“ æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåä¼šç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
- æ¯ä¸ªæµ‹è¯•çš„æ‰§è¡ŒçŠ¶æ€
- é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª
- æ€§èƒ½æŒ‡æ ‡
- å»ºè®®æ”¹è¿›ç‚¹

---

**æµ‹è¯•å¥—ä»¶å·²å‡†å¤‡å°±ç»ªï¼** ğŸ‰ å¼€å§‹éªŒè¯ç³»ç»ŸåŠŸèƒ½å§ï¼
